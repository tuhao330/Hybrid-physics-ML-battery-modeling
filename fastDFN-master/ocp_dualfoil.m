%% Open-Circuit Potential Functions from DUALFOIL
%   Created July 4, 2012 by Scott Moura

%   nneg = 3; MCMB 2528 graphite (Bellcore) 0.01 < x < 0.9
%   npos = 6; CoO2 (Cobalt Dioxide) 0.5 < y < 0.99


sto = linspace(0,1,101);


g0n = 0.194+1.5*exp(-120.0*sto) ...
     +0.0351*tanh((sto-0.286)/0.083) ... 
     - 0.0045*tanh((sto-0.849)/0.119) ...
     - 0.035*tanh((sto-0.9233)/0.05) ...
     - 0.0147*tanh((sto-0.5)/0.034) ...
     - 0.102*tanh((sto-0.194)/0.142) ...
     - 0.022*tanh((sto-0.9)/0.0164) ...
     - 0.011*tanh((sto-0.124)/0.0226) ...
     + 0.0155*tanh((sto-0.105)/0.029);
 
figure(1)
subplot(211)
plot(sto,g0n)

ct1 = 3.6e3 * 372 * 1800 / 96487;

  g1n = -1.5*(120.0/ct1)*exp(-120.0*sto)  ...
 +(0.0351/(0.083*ct1))*((cosh((sto-0.286)/0.083)).^(-2)) ...
 -(0.0045/(ct1*0.119))*((cosh((sto-0.849)/0.119)).^(-2)) ...
 -(0.035/(ct1*0.05))*((cosh((sto-0.9233)/0.05)).^(-2)) ...
 -(0.0147/(ct1*0.034))*((cosh((sto-0.5)/0.034)).^(-2)) ...
 -(0.102/(ct1*0.142))*((cosh((sto-0.194)/0.142)).^(-2)) ...
 -(0.022/(ct1*0.0164))*((cosh((sto-0.9)/0.0164)).^(-2)) ...
 -(0.011/(ct1*0.0226))*((cosh((sto-0.124)/0.0226)).^(-2)) ...
 +(0.0155/(ct1*0.029))*((cosh((sto-0.105)/0.029)).^(-2));

figure(1)
subplot(212)
plot(sto,g1n)




g0p = 2.16216+0.07645*tanh(30.834-54.4806*sto) ...
 + 2.1581*tanh(52.294-50.294*sto) ...
 - 0.14169*tanh(11.0923-19.8543*sto) ...
 + 0.2051*tanh(1.4684-5.4888*sto) ...
 + 0.2531*tanh((-sto+0.56478)/0.1316) ...
 - 0.02167*tanh((sto-0.525)/0.006);
 
figure(2)
subplot(211)
plot(sto,g0p);
xlim([0.5 1])


ct3 = 3.6e3 * 247 * 5010 / 96487;

g1p = 0.07645*(-54.4806/ct3)* ...
((1.0./cosh(30.834-54.4806*sto)).^2) ...
+2.1581*(-50.294/ct3)*((cosh(52.294-50.294*sto)).^(-2)) ...
+0.14169*(19.854/ct3)*((cosh(11.0923-19.8543*sto)).^(-2)) ...
-0.2051*(5.4888/ct3)*((cosh(1.4684-5.4888*sto)).^(-2)) ...
-0.2531/0.1316/ct3*((cosh((-sto+0.56478)/0.1316)).^(-2)) ...
 - 0.02167/0.006/ct3*((cosh((sto-0.525)/0.006)).^(-2));

figure(2)
subplot(212)
plot(sto,g1p)
xlim([0.5 1])
