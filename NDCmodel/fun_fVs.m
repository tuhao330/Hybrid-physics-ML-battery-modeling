% compute f(Vs)
% 1/(Cb+Cs) is assumed to be known
% x(1) = CbCbRb/(Cb+Cs)/(Cb+Cs), x(2) = (Cb+Cs)/Cb/Cs/Rb
function y = fun_fVs(x,udata)
global Vsh Ic Qt
poly = [3.2  2.5898   -9.0032   18.8674  -17.8199  6.3254];
y = poly(1)+poly(2)*(Vsh+1/Qt*Ic*udata+Ic*x(1)*(1-exp(-udata*x(2))))+...
    poly(3)*(Vsh+1/Qt*Ic*udata+Ic*x(1)*(1-exp(-udata*x(2)))).^2+ ... 
    poly(4)*(Vsh+1/Qt*Ic*udata+Ic*x(1)*(1-exp(-udata*x(2)))).^3+ ... 
    poly(5)*(Vsh+1/Qt*Ic*udata+Ic*x(1)*(1-exp(-udata*x(2)))).^4+ ... 
    poly(6)*(Vsh+1/Qt*Ic*udata+Ic*x(1)*(1-exp(-udata*x(2)))).^5;
end
